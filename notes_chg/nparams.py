import numpy as np

def nparams_block1(in_channels, mid1_channels, mid2_channels, out_channels):
    return (in_channels * mid1_channels * 9 + mid1_channels * mid2_channels * 9 * 2
                + mid1_channels * out_channels * 9)

def nparams_block2(in_channels, mid1_channels, mid2_channels, mid3_channels, out_channels):
    return (in_channels * mid1_channels * 25 + (mid1_channels * mid2_channels * 9 
            + mid2_channels * mid3_channels * 9) * 2 + mid1_channels * out_channels * 9)

def nparams_block3(in_channels, mid1_channels, mid2_channels, mid3_channels, out_channels):
    return (in_channels * mid1_channels * 25 + (mid1_channels * mid2_channels * 9 
            + mid2_channels * mid3_channels * 9) * 2 + mid1_channels * out_channels * 25 + out_channels)

if __name__ == '__main__':
    data_channels = 1
    conv_4 = nparams_block1(data_channels, 32, 64, 1)
    conv_2 = nparams_block2(data_channels + 1, 32, 64, 128, 1)
    conv_1 = nparams_block3(data_channels + 1, 32, 64, 128, 8)
    print('MSNet3')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4:d}')

    conv_8 = nparams_block1(data_channels + 1, 32, 64, 1)
    conv_4 = nparams_block1(data_channels + 1, 32, 64, 1)
    conv_2 = nparams_block2(data_channels + 1, 32, 64, 96, 1)
    conv_1 = nparams_block3(data_channels + 1, 32, 64, 128, 8)
    print('\nMSNet4')
    print(f'conv_8 = {conv_8:d}')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4 + conv_8:d}')

    conv_16 = nparams_block1(data_channels, 32, 64, 1)
    conv_8 = nparams_block1(data_channels + 1, 32, 64, 1)
    conv_4 = nparams_block1(data_channels + 1, 32, 64, 1)
    conv_2 = nparams_block2(data_channels + 1, 32, 48, 96, 1)
    conv_1 = nparams_block3(data_channels + 1, 32, 64, 128, 8)
    print('\nMSNet5')
    print(f'conv_16 = {conv_16:d}')
    print(f'conv_8 = {conv_8:d}')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4 + conv_8 + conv_16:d}')

    conv_16 = nparams_block1(data_channels, 20, 40, 1)
    conv_8 = nparams_block1(data_channels + 1, 20, 40, 1)
    conv_4 = nparams_block1(data_channels + 1, 20, 40, 1)
    conv_2 = nparams_block2(data_channels + 1, 20, 40, 80, 1)
    conv_1 = nparams_block3(data_channels + 1, 20, 40, 80, 8)
    print('\nMSNet5_small')
    print(f'conv_16 = {conv_16:d}')
    print(f'conv_8 = {conv_8:d}')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4 + conv_8 + conv_16:d}')

    conv_16 = nparams_block1(data_channels, 32, 64, 1)
    conv_8 = nparams_block1(data_channels + 1, 50, 100, 1)
    conv_4 = nparams_block1(data_channels + 1, 54, 110, 1)
    conv_2 = nparams_block2(data_channels + 1, 32, 64, 112, 1)
    conv_1 = nparams_block3(data_channels + 1, 32, 64, 128, 8)
    print('\nMSNet5_big')
    print(f'conv_16 = {conv_16:d}')
    print(f'conv_8 = {conv_8:d}')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4 + conv_8 + conv_16:d}')

    conv_16 = nparams_block1(data_channels, 32, 64, 1)
    conv_8 = nparams_block1(data_channels + 1, 96, 144, 1)
    conv_4 = nparams_block1(data_channels + 1, 96, 144, 1)
    conv_2 = nparams_block2(data_channels + 1, 32, 64, 112, 1)
    conv_1 = nparams_block3(data_channels + 1, 32, 64, 128, 8)
    print('\nMSNet5_big_1')
    print(f'conv_16 = {conv_16:d}')
    print(f'conv_8 = {conv_8:d}')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4 + conv_8 + conv_16:d}')

    conv_16 = nparams_block1(data_channels, 32, 64, 1)
    conv_8 = nparams_block1(data_channels + 1, 50, 100, 1)
    conv_4 = nparams_block1(data_channels + 1, 54, 110, 1)
    conv_2 = nparams_block2(data_channels + 1, 48, 96, 128, 1)
    conv_1 = nparams_block3(data_channels + 1, 48, 96, 144, 8)
    print('\nMSNet5_big_2')
    print(f'conv_16 = {conv_16:d}')
    print(f'conv_8 = {conv_8:d}')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4 + conv_8 + conv_16:d}')

    conv_32 = nparams_block1(data_channels + 1, 16, 32, 1)
    conv_16 = nparams_block1(data_channels + 1, 32, 64, 1)
    conv_8 = nparams_block1(data_channels + 1, 32, 64, 1)
    conv_4 = nparams_block1(data_channels + 1, 32, 64, 1)
    conv_2 = nparams_block2(data_channels + 1, 32, 52, 96, 1)
    conv_1 = nparams_block3(data_channels + 1, 32, 64, 112, 8)
    print('\nMSNet6')
    print(f'conv_32 = {conv_32:d}')
    print(f'conv_16 = {conv_16:d}')
    print(f'conv_8 = {conv_8:d}')
    print(f'conv_4 = {conv_4:d}')
    print(f'conv_2 = {conv_2:d}')
    print(f'conv_1 = {conv_1:d}')
    print(f'nparams = {conv_1 + conv_2 + conv_4 + conv_8 + conv_16 + conv_32:d}')